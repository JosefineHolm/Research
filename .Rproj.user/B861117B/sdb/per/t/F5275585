{
    "collab_server" : "",
    "contents" : "#load data\n\nreal=read.table(file=\"real.csv\", header=TRUE, sep=\",\")\nnames(real)\nstr(real)\n\n# We need to change treatments into factors, with baseline treatment being the first\nreal$condition = factor(real$condition, levels = c(\"1\", \"2\", \"3\", \"4\"))\n#We check if it worked - it did ! \nstr(real)\n\n#We need to install a lot of extra packages\nlibrary(lattice)\ninstall.packages(\"lme4\")\nlibrary(lme4)\nlibrary(geepack)\ninstall.packages(\"lsmeans\")\nlibrary(lsmeans)\ninstall.packages(\"dplyr\")\nlibrary(dplyr)\ninstall.packages(\"MuMIn\")\nlibrary(MuMIn)\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\n\n\n#Chosen model General liniar model with fixed randomization of the individuals \n#with poisson distribution because I am working with count data\n#########################################################################################\n#Behavior: Grunt\nM1=glmer(grunt ~ treatment + (1 | id), family=poisson, data=real)\n\n#Plotting residuals to check if we can use this model\nop=par(mfrow=c(2,2), mar=c(5,4,1,2))\nplot(M1, add.smooth=FALSE, which=1)\nE=resid(M1)\nhist(E,xlab=\"residuals\", main=\"\")\nplot(real$treatment, E, xlab=\"Treatment\", ylab=\"residuals\")\nplot(real$id, E, xlab=\"id\", ylab=\"residuals\")\n#The residuals appear normal and the residuala do not differ to much depending on treatment or individual\nsummary(M1)\n# We can see that the amount of grunts are different in between treatmens\n# Now we see how the change\nlsmeans(M1,pairwise~treatment)\n\n#The amount of grunts decreased significantly from baselin to treatment 1, and increase\n# from 1-2 and 1-3. \n\n#making a table that will show the means per individual that can be graphed\nx1 <- group_by(real, treatment, id) %>%\n  summarize(m.grunt = mean(grunt, na.rm = TRUE), # na.rm = TRUE to remove missing values\n            s.grunt=sd(grunt, na.rm = TRUE),  # na.rm = TRUE to remove missing values\n            n = sum(!is.na(grunt)), # of observations, excluding NAs.\n            se.grunt=s.grunt/sqrt(n))\n#Graphing grunts \nggplot(data=x1,\n       aes(x=treatment, y=m.grunt, fill=id, label=m.grunt)) +\n  geom_bar(stat=\"identity\", position=position_dodge(), color = \"black\") +\n  geom_errorbar(aes(ymin=m.grunt, ymax=m.grunt+se.grunt), width=0.2,\n                position=position_dodge(0.9)) +\n  scale_fill_manual(values=c(\"black\",\"white\", \"light grey\", \"dark grey\")) +\n  xlab(\"ID\") +\n  ylab(\"Number of grunt\") +\n  ylim(0,15) +\n  labs(fill=\"id\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(),\n        panel.grid.minor=element_blank(),\n        legend.title=element_text(size=6),\n        legend.key=element_blank(),\n        legend.position=c(0.5,0.95),\n        legend.text=element_text(size=8),\n        legend.background=element_blank(),\n        legend.direction=\"horizontal\",\n        legend.key.size=unit(0.3, \"cm\"),\n        axis.title.y=element_text(size=8),\n        axis.title.x=element_text(size=8),\n        axis.text.x=element_text(size=8))\n#So here we can see which individial changed how much in each treatment \n\n\n###########################################################################################\n#Decrease proximity\nM2=glmer(decrease ~ condition + (1 | id), family=poisson, data=real) \nop=par(mfrow=c(2,2), mar=c(5,4,1,2))\nplot(M2, add.smooth=FALSE, which=1, xlab=\"Fitted values\", ylab= \"Residuals\")\n\nE1=residuals(M2)\nF1=fitted(M2)\nPlot(F1, E1, xlab=\"Fittet values\", ylab=\"residuals\")\nplot(M2, add.smooth=FALSE, xlab=\"Fitted values\", ylab= \"Residuals\")\nE=resid(M2)\nhist(E,xlab=\"Residuals\", main=\"\")\nplot(real$condition, E, xlab=\"Condition\", ylab=\"Residuals\")\nplot(real$id, E, xlab=\"ID\", ylab=\"Residuals\")\nplot(F1, E1, xlab=\"Fittet values\", ylab=\"Residuals\")\n\n#Again the residuals look okay so we continue\nsummary(M2)\n#We also see a change over treatments\n#Lets look closer \nlsmeans(M2,pairwise~condition)\n#Significant from 3-2, b-3,1-2,1-3,2-3 where it increase,.\n\n#making a table that will show the means per individual that can be graphed\nx2 <- group_by(real, condition, id) %>%\n  summarize(m.decrease = mean(decrease, na.rm = TRUE), # na.rm = TRUE to remove missing values\n            s.decrease=sd(decrease, na.rm = TRUE),  # na.rm = TRUE to remove missing values\n            n = sum(!is.na(decrease)), # of observations, excluding NAs.\n            se.decrease=s.decrease/sqrt(n))\n#Graphing decreased proximity \nggplot(data=x2,\n       aes(x=condition, y=m.decrease, fill=id, label=m.decrease)) +\n  geom_bar(stat=\"identity\", position=position_dodge(), color = \"black\") +\n  geom_errorbar(aes(ymin=m.decrease, ymax=m.decrease+se.decrease), width=0.2,\n                position=position_dodge(0.9)) +\n  scale_fill_manual(values=c(\"black\",\"white\", \"light grey\", \"dark grey\")) +\n  xlab(\"ID\") +\n  ylab(\"Decrease proximity\") +\n  ylim(0,30) +\n  labs(fill=\"id\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(),\n        panel.grid.minor=element_blank(),\n        legend.title=element_text(size=6),\n        legend.key=element_blank(),\n        legend.position=c(0.5,0.95),\n        legend.text=element_text(size=8),\n        legend.background=element_blank(),\n        legend.direction=\"horizontal\",\n        legend.key.size=unit(0.3, \"cm\"),\n        axis.title.y=element_text(size=8),\n        axis.title.x=element_text(size=8),\n        axis.text.x=element_text(size=8))\n\n#######################################################################################\n#Plucking\nM3=glmer(plucking ~ treatment + (1 | id), family=poisson, data=real) \n#Plotting residuals to check if we can use this model\nop=par(mfrow=c(2,2), mar=c(5,4,1,2))\nplot(M3, add.smooth=FALSE, which=1)\nE=resid(M3)\nhist(E,xlab=\"residuals\", main=\"\")\nplot(real$treatment, E, xlab=\"Treatment\", ylab=\"residuals\")\nplot(real$id, E, xlab=\"id\", ylab=\"residuals\")\n#The residuals appear normal but differs very much per individual cause stevie is the \n#only one plucking\nsummary(M3)\n#We also see a change over treatments\n#Lets look closer \nlsmeans(M3,pairwise~treatment)\n#There are significant decrease between b-3, 1-2 and 1-3. \n\n#making a table that will show the means per individual that can be graphed\nx3 <- group_by(real, treatment, id) %>%\n  summarize(m.plucking = mean(plucking, na.rm = TRUE), # na.rm = TRUE to remove missing values\n            s.plucking=sd(plucking, na.rm = TRUE),  # na.rm = TRUE to remove missing values\n            n = sum(!is.na(plucking)), # of observations, excluding NAs.\n            se.plucking=s.plucking/sqrt(n))\n#Graphing plucking\nggplot(data=x3,\n       aes(x=treatment, y=m.plucking, fill=id, label=m.plucking)) +\n  geom_bar(stat=\"identity\", position=position_dodge(), color = \"black\") +\n  geom_errorbar(aes(ymin=m.plucking, ymax=m.plucking+se.plucking), width=0.2,\n                position=position_dodge(0.9)) +\n  scale_fill_manual(values=c(\"black\",\"white\", \"light grey\", \"dark grey\")) +\n  xlab(\"ID\") +\n  ylab(\"Plucking\") +\n  ylim(0,8) +\n  labs(fill=\"id\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(),\n        panel.grid.minor=element_blank(),\n        legend.title=element_text(size=6),\n        legend.key=element_blank(),\n        legend.position=c(0.5,0.95),\n        legend.text=element_text(size=8),\n        legend.background=element_blank(),\n        legend.direction=\"horizontal\",\n        legend.key.size=unit(0.3, \"cm\"),\n        axis.title.y=element_text(size=8),\n        axis.title.x=element_text(size=8),\n        axis.text.x=element_text(size=8))\n#As we can see it is only that is effected by the treatments when it comes to plucking\n#######################################################################################\n#Increase proximity \nM4=glmer(increase ~ treatment + (1 | id), family=poisson, data=real)\n#Plotting residuals to check if we can use this model\nop=par(mfrow=c(2,2), mar=c(5,4,1,2))\nplot(M4, add.smooth=FALSE, which=1)\nE=resid(M4)\nhist(E,xlab=\"residuals\", main=\"\")\nplot(real$treatment, E, xlab=\"Treatment\", ylab=\"residuals\")\nplot(real$id, E, xlab=\"id\", ylab=\"residuals\")\n#The residuals appear normal and the residuala do not differ to much depending on treatment or individual\nsummary(M4)\n#We also see a change over treatments\n#Lets look closer \nlsmeans(M4,pairwise~treatment)\n#significant decrease between b-2, b-3, 1-2, 1-3 and 2-3. All exept for between baseline and 1\n\n#making a table that will show the means per individual that can be graphed\nx4 <- group_by(real,treatment, id) %>%\n  summarize(m.increase = mean(increase, na.rm = TRUE), # na.rm = TRUE to remove missing values\n            s.increase=sd(increase, na.rm = TRUE),  # na.rm = TRUE to remove missing values\n            n = sum(!is.na(increase)), # of observations, excluding NAs.\n            se.increase=s.increase/sqrt(n))\n#Graphing increases proximity \nggplot(data=x4,\n       aes(x=treatment, y=m.increase, fill=id, label=m.increase)) +\n  geom_bar(stat=\"identity\", position=position_dodge(), color = \"black\") +\n  geom_errorbar(aes(ymin=m.increase, ymax=m.increase+se.increase), width=0.2,\n                position=position_dodge(0.9)) +\n  scale_fill_manual(values=c(\"black\",\"white\", \"light grey\", \"dark grey\")) +\n  xlab(\"ID\") +\n  ylab(\"Increase Proximity\") +\n  ylim(0,15) +\n  labs(fill=\"id\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(),\n        panel.grid.minor=element_blank(),\n        legend.title=element_text(size=6),\n        legend.key=element_blank(),\n        legend.position=c(0.5,0.95),\n        legend.text=element_text(size=8),\n        legend.background=element_blank(),\n        legend.direction=\"horizontal\",\n        legend.key.size=unit(0.3, \"cm\"),\n        axis.title.y=element_text(size=8),\n        axis.title.x=element_text(size=8),\n        axis.text.x=element_text(size=8))\n#####################################################################################\n#Selfgrooming\nM5=glmer(selfgroom ~ treatment + (1 | id), family=poisson, data=real) \n#Plotting residuals to check if we can use this model\nop=par(mfrow=c(2,2), mar=c(5,4,1,2))\nplot(M5, add.smooth=FALSE, which=1)\nE=resid(M5)\nhist(E,xlab=\"residuals\", main=\"\")\nplot(real$treatment, E, xlab=\"Treatment\", ylab=\"residuals\")\nplot(real$id, E, xlab=\"id\", ylab=\"residuals\")\n#The residuals appear normal but their might be some complication of the treatment and id. But we go on anyway. \nsummary(M5)\n#Doesn?t seem like there is a significant difference but let?s look closer\nlsmeans(M5,pairwise~treatment)\n#There is no significant difference \n\n#making a table that will show the means per individual that can be graphed\nx5 <- group_by(real, treatment, id) %>%\n  summarize(m.selfgroom = mean(selfgroom, na.rm = TRUE), # na.rm = TRUE to remove missing values\n            s.selfgroom=sd(selfgroom, na.rm = TRUE),  # na.rm = TRUE to remove missing values\n            n = sum(!is.na(selfgroom)), # of observations, excluding NAs.\n            se.selfgroom=s.selfgroom/sqrt(n))\n#Graphing selfgroom\nggplot(data=x5,\n       aes(x=treatment, y=m.selfgroom, fill=id, label=m.selfgroom)) +\n  geom_bar(stat=\"identity\", position=position_dodge(), color = \"black\") +\n  geom_errorbar(aes(ymin=m.selfgroom, ymax=m.selfgroom+se.selfgroom), width=0.2,\n                position=position_dodge(0.9)) +\n  scale_fill_manual(values=c(\"black\",\"white\", \"light grey\", \"dark grey\")) +\n  xlab(\"ID\") +\n  ylab(\"Selfgroom\") +\n  ylim(0,8) +\n  labs(fill=\"id\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(),\n        panel.grid.minor=element_blank(),\n        legend.title=element_text(size=6),\n        legend.key=element_blank(),\n        legend.position=c(0.5,0.95),\n        legend.text=element_text(size=8),\n        legend.background=element_blank(),\n        legend.direction=\"horizontal\",\n        legend.key.size=unit(0.3, \"cm\"),\n        axis.title.y=element_text(size=8),\n        axis.title.x=element_text(size=8),\n        axis.text.x=element_text(size=8))\n#####################################################################################\n#Foraging\nM6=glmer(foraging ~ treatment + (1 | id), family=poisson, data=real) \n#Plotting residuals to check if we can use this model\nop=par(mfrow=c(2,2), mar=c(5,4,1,2))\nplot(M6, add.smooth=FALSE, which=1)\nE=resid(M6)\nhist(E,xlab=\"residuals\", main=\"\")\nplot(real$treatment, E, xlab=\"Treatment\", ylab=\"residuals\")\nplot(real$id, E, xlab=\"id\", ylab=\"residuals\")\n#The residuals appear normal the residuala do not differ to much depending on treatment or individual\nsummary(M6)\n#Looks like there will be significant differences\n#Let?s look closer\nlsmeans(M6,pairwise~treatment)\n#Significant increase from b-2, and b-3. \n\n#making a table that will show the means per individual that can be graphed\nx6 <- group_by(real,treatment, id) %>%\n  summarize(m.foraging = mean(foraging, na.rm = TRUE), # na.rm = TRUE to remove missing values\n            s.foraging=sd(foraging, na.rm = TRUE),  # na.rm = TRUE to remove missing values\n            n = sum(!is.na(foraging)), # of observations, excluding NAs.\n            se.foraging=s.foraging/sqrt(n))\n#Graphing foraging\nggplot(data=x6,\n       aes(x=treatment, y=m.foraging, fill=id, label=m.foraging)) +\n  geom_bar(stat=\"identity\", position=position_dodge(), color = \"black\") +\n  geom_errorbar(aes(ymin=m.foraging, ymax=m.foraging+se.foraging), width=0.2,\n                position=position_dodge(0.9)) +\n  scale_fill_manual(values=c(\"black\",\"white\", \"light grey\", \"dark grey\")) +\n  xlab(\"ID\") +\n  ylab(\"Foraging\") +\n  ylim(0,27) +\n  labs(fill=\"id\") +\n  theme_bw() +\n  theme(panel.grid.major=element_blank(),\n        panel.grid.minor=element_blank(),\n        legend.title=element_text(size=6),\n        legend.key=element_blank(),\n        legend.position=c(0.5,0.95),\n        legend.text=element_text(size=8),\n        legend.background=element_blank(),\n        legend.direction=\"horizontal\",\n        legend.key.size=unit(0.3, \"cm\"),\n        axis.title.y=element_text(size=8),\n        axis.title.x=element_text(size=8),\n        axis.text.x=element_text(size=8))\n",
    "created" : 1507751912318.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4199515554",
    "id" : "F5275585",
    "lastKnownWriteTime" : 1490390325,
    "last_content_update" : 1490390325,
    "path" : "C:/CWU/Advanced statistics/finalpresentation.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}